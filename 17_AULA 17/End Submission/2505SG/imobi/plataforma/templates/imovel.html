{% extends 'base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'plataforma/css/home.css' %}">
<style>
    /* MEHORIA APLICADA: movendo estilos inline para o CSS */
    .text-left {
        text-align: left;
    }
</style>
{% endblock %}

{% block content %}
<div class="container"> <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            {% for imagem in imovel.imagens.all %}
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="{{ forloop.counter0 }}" class="{% if forloop.first %}active{% endif %}" aria-current="true" aria-label="Slide {{ forloop.counter }}"></button>
            {% endfor %}
        </div>

        <div class="carousel-inner">
            {% for imagem in imovel.imagens.all %}
                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                    <img src="{{ imagem.img.url }}" class="d-block w-100" alt="Imagem do imóvel {{ forloop.counter }}">
                </div>
            {% endfor %}
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Próximo</span>
        </button>
    </div>

    <br>

    <div class="row text-center">
        <div class="col-md">
            <h3 class="titulo_especificacao">Valor</h3>
            <p class="especificacao">R$ {{ imovel.valor }}</p>
        </div>
        <div class="col-md">
            <h3 class="titulo_especificacao">Quartos</h3>
            <p class="especificacao">{{ imovel.quartos }} Quartos</p>
        </div>
        <div class="col-md">
            <h3 class="titulo_especificacao">Tamanho</h3>
            <p class="especificacao">{{ imovel.tamanho }}m²</p>
        </div>
    </div>

    <br><br>

    <div class="text-left">
        <h3 class="titulo_especificacao">Endereço</h3>
        <p class="especificacao_endereco">{{ imovel.rua }}, {{ imovel.cidade }}</p>
        <br>
        <h3 class="titulo_especificacao">Descrição</h3>
        <p class="especificacao_endereco">{{ imovel.descricao }}</p>
        <br>

        <button class="btn_agendar_visita" data-bs-toggle="modal" data-bs-target="#modalAgendarVisita">
            AGENDAR VISITA
        </button>
        <br><br>
    </div>

    <hr style="border: 1px solid black">
    <br>

    <div class="div_possivel_interesse">
        <h3 class="titulo_especificacao">Talvez você se interesse por</h3>
        <div class="row">
            {% for sugestao in sugestoes %}
            <div class="col-md cont">
                <div class="card_imovel">
                    <img class="img_capa_imovel" src="{{ sugestao.imagens.all.0.img.url }}">
                    <div class="informacoes_imoveis">
                        <a class="a_none" href="{% url 'imovel' sugestao.id %}">
                            <h4 class="valor">R$ {{ sugestao.valor }}</h4>
                        </a>
                        <p>{{ sugestao.rua }}, {{ sugestao.cidade }}</p>
                        <br>
                        <img width="7%" src="{% static 'plataforma/img/heart.png' %}">
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<div class="modal fade" id="modalAgendarVisita" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered"> <div class="modal-content">

      <button class="btn_agendar_visita" data-bs-toggle="modal" data-bs-target="#modalAgendarVisita"
        style="background-color: #30CD9E; color: white; border: none; padding: 8px 15px; font-weight: bold; border-radius: 5px; cursor: pointer;">
        AGENDAR VISITA
      </button>

      <form action="{% url 'agendar_visitas' %}" method="POST">
        {% csrf_token %}
        <input type="hidden" name="id_imovel" value="{{ imovel.id }}">

        <div class="modal-body">
            <p>Selecione a data e o horário desejados para visitar o imóvel.</p>

            <div class="mb-3"> <label for="dia-visita" class="form-label">Escolha um dia:</label>
              <select name="dia" id="dia-visita" class="form-select" required>
                <option selected disabled value="">Selecione uma data...</option>
                {% for dia in imovel.dias_visita.all %}
                  <option value="{{ dia.dia }}">{{ dia }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="mb-3">
              <label for="horario-visita" class="form-label">Escolha um horário:</label>
              <select name="horario" id="horario-visita" class="form-select" required>
                <option selected disabled value="">Selecione um horário...</option>
                    {% for horario in imovel.horarios.all %}
                      <option value="{{ horario }}">{{ horario }}</option>
                    {% endfor %}
              </select>
                <input name="id_imovel" type="hidden" value="{{imovel.id}}">
                <br>
                <input class="btn_agendar" type="submit" value="AGENDAR">
            </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-success">Confirmar Agendamento</button>
        </div>
      </form>
      </div>
  </div>
</div>


{% endblock %}